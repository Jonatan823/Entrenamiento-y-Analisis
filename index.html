<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SLER - Entrenamiento y Análisis</title>
    <style>
        body { font-family: monospace; padding: 40px; background: #fff; display: flex; flex-direction: column; align-items: center; }
        .header { width: 100%; max-width: 800px; border-bottom: 2px solid #000; margin-bottom: 20px; text-align: center; }
        .timers-container { display: flex; gap: 40px; margin: 20px 0; }
        .timer-box { text-align: center; width: 150px; }
        .timer-val { font-size: 32px; font-weight: bold; }
        .label { font-size: 11px; text-transform: uppercase; color: #666; margin-bottom: 5px; }
        
        .training-box { 
            width: 100%; max-width: 750px; min-height: 250px; border: 1px solid #ccc;
            padding: 40px; margin: 20px 0; white-space: pre-wrap;
            font-size: 22px; line-height: 1.8; font-weight: bold; display: none;
            background: #fdfdfd;
        }
        
        .controls { margin-top: 20px; }
        button { 
            padding: 15px 40px; cursor: pointer; font-family: monospace; 
            font-weight: bold; background: #000; color: #fff; border: none;
            text-transform: uppercase;
        }
        button:active { transform: scale(0.98); }

        table { width: 100%; max-width: 800px; border-collapse: collapse; margin-top: 30px; display: none; }
        th, td { border: 1px solid #000; padding: 12px; text-align: center; font-size: 14px; }
    </style>
</head>
<body>

    <div class="header">
        <h3>NODO DE ENTRENAMIENTO Y ANÁLISIS: NIVEL <span id="lvlDisplay">1</span></h3>
    </div>

    <div class="timers-container">
        <div class="timer-box" id="stdContainer">
            <div class="label">Tiempo Estándar</div>
            <div class="timer-val" id="timerStd">0.000s</div>
        </div>
        <div class="timer-box" id="slerContainer" style="opacity: 0.2;">
            <div class="label">Tiempo SLER</div>
            <div class="timer-val" id="timerSler">0.000s</div>
        </div>
    </div>

    <div id="exerciseBox" class="training-box"></div>

    <div class="controls">
        <button id="mainBtn" onclick="handleFlow()">Iniciar Lectura Estándar</button>
    </div>

    <table id="resultsTable">
        <thead>
            <tr>
                <th>Nivel</th>
                <th>Renglones</th>
                <th>Estándar (s)</th>
                <th>SLER (s)</th>
                <th>Mejoría</th>
            </tr>
        </thead>
        <tbody id="statsBody"></tbody>
    </table>

<script>
    let startTime, timerInterval;
    let currentLvl = 1;
    let currentMode = 'IDLE'; // IDLE, RUNNING_STD, WAIT_SLER, RUNNING_SLER
    let results = [];

    const levels = [
        { lines: 2, std: "La lectura fluida requiere una práctica constante.\nEl sistema visual se adapta al ritmo propuesto.", 
          sler: "LA LECTURA FLUIDA REQUIERE UNA PRÁCTI-\n-CA CONSTANTE. EL SISTEMA VISUAL SE A-\n-DAPTA AL RITMO PROPUESTO." },
        { lines: 4, std: "El desarrollo de la neurociencia aplicada permite\noptimizar los procesos de captura de información.\nCada renglón demanda un esfuerzo muscular ciliar\nque el sistema SLER busca reducir drásticamente.", 
          sler: "EL DESARROLLO DE LA NEUROCIENCIA APLI-\n-CADA PERMITE OPTIMIZAR LOS PROCESOS-\n-DE CAPTURA DE INFORMACIÓN. CADA REN-\n,GLÓN DEMANDA UN ESFUERZO MUSCULAR." },
        { lines: 6, std: "Cuando el ojo llega al final de una línea común,\nse produce un salto sacádico de retorno forzado.\nEste movimiento es mecánico y no aporta datos,\ngenerando un vacío de milisegundos en el foco.\nLa fatiga aumenta proporcionalmente a la carga,\nlimitando la evolución natural de la lectura.", 
          sler: "CUANDO EL OJO LLEGA AL FINAL DE UNA LÍ-\n-NEA COMÚN, SE PRODUCE UN SALTO SACÁ-\n-DICO DE RETORNO FORZADO. ESTE MOVI-\n,MIENTO ES MECÁNICO Y NO APORTA DA-\n-TOS, GENERANDO UN VACÍO DE MILISE-\n.GUNDOS EN EL FOCO ACTUAL." },
        { lines: 10, std: "El algoritmo de entrenamiento final es técnico.\nRequiere concentración absoluta en voz alta.\nEvite distracciones externas durante el proceso.\nObserve cómo su cerebro procesa cada sílaba.\nLa métrica final validará su evolución neural.\nNo detenga el flujo hasta terminar el bloque.\nLa persistencia es clave en el sistema SLER.\nCada binomio refuerza la conexión visual.\nAnalice su propia mejora en los parciales.\nFinalice la sesión para registrar sus datos.", 
          sler: "EL ALGORITMO DE ENTRENAMIENTO FINAL-\n-ES TÉCNICO. REQUIERE CONCENTRACIÓN-\n-ABSOLUTA EN VOZ ALTA. EVITE DISTRAC-\n,CIONES EXTERNAS DURANTE EL PROCESO.\nOBSERVE CÓMO SU CEREBRO PROCESA CA-\n-DA SÍLABA. LA MÉTRICA FINAL VALIDA-\n-RÁ SU EVOLUCIÓN NEURAL. NO DETENGA-\n,EL FLUJO HASTA TERMINAR EL BLOQUE.\nLA PERSISTENCIA ES CLAVE EN EL SISTE-\n.MA SLER DE LECTURA RECÍPROCA." }
    ];

    function handleFlow() {
        const btn = document.getElementById('mainBtn');
        const box = document.getElementById('exerciseBox');
        const data = levels[currentLvl - 1];

        if (currentMode === 'IDLE') {
            currentMode = 'RUNNING_STD';
            box.innerText = data.std;
            box.style.display = 'block';
            btn.innerText = "Finalizar Lectura Estándar";
            startClock('timerStd');
        } 
        else if (currentMode === 'RUNNING_STD') {
            stopClock();
            currentMode = 'WAIT_SLER';
            box.style.display = 'none';
            btn.innerText = "Iniciar Lectura SLER";
            document.getElementById('slerContainer').style.opacity = "1";
        }
        else if (currentMode === 'WAIT_SLER') {
            currentMode = 'RUNNING_SLER';
            box.innerText = data.sler;
            box.style.display = 'block';
            btn.innerText = "Finalizar Lectura SLER";
            startClock('timerSler');
        }
        else if (currentMode === 'RUNNING_SLER') {
            stopClock();
            recordResults();
            if (currentLvl < levels.length) {
                currentLvl++;
                prepareNextLevel();
            } else {
                showFinalStats();
            }
        }
    }

    function startClock(id) {
        startTime = performance.now();
        timerInterval = setInterval(() => {
            const delta = (performance.now() - startTime) / 1000;
            document.getElementById(id).innerText = delta.toFixed(3) + "s";
        }, 10);
    }

    function stopClock() { clearInterval(timerInterval); }

    function recordResults() {
        results.push({
            lvl: currentLvl,
            lines: levels[currentLvl-1].lines,
            std: document.getElementById('timerStd').innerText,
            sler: document.getElementById('timerSler').innerText
        });
    }

    function prepareNextLevel() {
        currentMode = 'IDLE';
        document.getElementById('exerciseBox').style.display = 'none';
        document.getElementById('lvlDisplay').innerText = currentLvl;
        document.getElementById('timerStd').innerText = "0.000s";
        document.getElementById('timerSler').innerText = "0.000s";
        document.getElementById('slerContainer').style.opacity = "0.2";
        document.getElementById('mainBtn').innerText = "Iniciar Lectura Estándar";
    }

    function showFinalStats() {
        document.getElementById('exerciseBox').style.display = 'none';
        document.getElementById('mainBtn').style.display = 'none';
        document.getElementById('resultsTable').style.display = 'table';
        const body = document.getElementById('statsBody');
        results.forEach(r => {
            let s1 = parseFloat(r.std), s2 = parseFloat(r.sler);
            let imp = (((s1 - s2) / s1) * 100).toFixed(1) + "%";
            body.innerHTML += `<tr><td>${r.lvl}</td><td>${r.lines}</td><td>${r.std}</td><td>${r.sler}</td><td>${imp}</td></tr>`;
        });
    }
</script>
</body>
</html>
